# הנחיות כלליות למערכת חילן פרו

## 2.1 אירועים

מערכת "חילן פרו" מבוססת על מאגר נתונים. הנתונים מדווחים באמצעות **אירועים**. כל אירוע מכיל מספר מצומצם של נתונים (בעלי קשר משותף) ומתייחס לנגררת (סגמנט) שבה מאוחסנים הנתונים במאגר הנתונים.

### זיהוי אירועים
כל אירוע מזוהה על ידי מספר בן 3 או 4 ספרות:

| ספרת מאות | סוג האירוע |
|-----------|------------|
| 1-- | אירועים מפעליים |
| 2--, 3--, 4--, 5--, 6-- | אירועי עובד איכותיים וכמותיים |
| 8-- | אירועי כוח אדם בבניה פרטנית לפי דרישות המפעל |

---

## 2.2 דיווח נתונים משותפים לכל האירועים

### בכל האירועים יופיעו:

| שדה | טורים | הערות |
|-----|-------|-------|
| מספר האירוע | 1-3 | |
| מספר המפעל | 4-7 | זיהוי קבוע של המפעל. ניתן להשתמש לרישום מקור הדיווח |
| קוד עדכון | 8 (מפעל) / 40 (עובד) | |

### באירועי עובד יופיעו גם:

| שדה | טורים | הערות |
|-----|-------|-------|
| מספר העובד | 8-16 | הספרה הימנית היא ספרת ביקורת. ניתן לרשום * אם לא ידועה |
| שם המשפחה | 17-26 | רשות |
| שם פרטי | 27-33 | רשות |
| מספר דף | 34-37 | חובה באירועים כמותיים |

> [!NOTE]
> אין לדווח מספר עובד קטן מ-10.

---

## 2.3 מפתח

שדה מפתח קיים בנתונים בעלי מספר מופעים משתנה ומטרתו יצירת קשר בין האירוע ובין המופע המתאים.

### סוגי מפתחות:

1. **מפתח תאריך בלבד** - דוגמה: אירוע תקן (תאריך קבלת התקן)
2. **מפתח סמל (לא תאריך)** - דוגמה: מספר זהות באירוע פרטי ילד
3. **מפתח מורכב (סמל + תאריך)** - דוגמה: אירוע 209

> [!TIP]
> לנתונים בעלי מופע יחיד (כמו פרטי צבא) אין מפתח.

---

## 2.4 תקופת תוקף

במערכת רטרואקטיבית יש חשיבות רבה לתקופת התוקף של כל דיווח. תקופת התוקף היא התקופה שבה האירוע משפיע על חישוב השכר.

### סוגי אירועים לפי תקופת תוקף:

| סוג | דוגמה | הסבר |
|-----|-------|------|
| חסר תקופת תוקף | אירוע 546 - שפות | אין עניין בתקופה |
| תאריך התחלה + גמר תוקף | אירוע 209 - מרכיבי שכר | זכאות לתקופה מסוימת |
| תאריך התחלה בלבד | אירוע 203 - דרגה | בתוקף עד לאירוע הבא |

> [!IMPORTANT]
> **ברירות מחדל:**
> - אם לא דווח תאריך תוקף → האירוע בתוקף מתחילת חודש הדיווח
> - אם לא דווח תאריך גמר תוקף → האירוע בתוקף עד להודעה חדשה

---

## 2.5 קודי פעולה (עדכון)

קוד הפעולה מציין כיצד ישפיע האירוע על מאגר הנתונים.

### טבלת קודי פעולה:

| קוד | פעולה | הסבר |
|-----|-------|------|
| ' ' (ריק) | הוספה | דיווח נגררת חדשה |
| '2' | החלפה (עדכון) | שינוי שדות בנגררת קיימת |
| '3' | ביטול | ביטול נתונים או דיווח גמר תוקף |
| '4' | קביעה | רק לאירועים עם תאריך במפתח |
| '5' | ביטול מאסיבי | רק לחלק מהאירועים |
| '6' | שילוב 2+4 | אירוע 205/274 בלבד |
| '7' | ייחודי | אירוע 274 בלבד |

---

### ' ' - פעולת הוספה

משמשת לדיווח נגררת חדשה למאגר הנתונים.

**מתי להשתמש:**

1. **מפתח סמל** - דיווח ראשון של סמל זה (דוגמה: הולדת ילד חדש)
2. **מפתח תאריך עם גמר תוקף** - כשאין אירוע בתוקף ואין אירוע מאוחר יותר
3. **מפתח תאריך ללא גמר תוקף** - כשאין אירוע בתוקף או כשמדווחים אירוע מוקדם מכולם
4. **מפתח מורכב** - כשאין אירוע בתוקף לסמל המדווח

---

### '2' - פעולת החלפה (עדכון)

משמשת לשינוי שדות בנגררת בודדת קיימת.

> [!WARNING]
> - ניתן לשנות כל שדה למעט שדה מפתח שאינו תאריך
> - יש לדווח 0 בשדה שהיה לו ערך ורוצים שיהיה ריק

**מצבים אפשריים:**

| מצב | תוצאה |
|-----|-------|
| קיימת נגררת עם אותו תאריך תוקף | השדות מתעדכנים בנגררת זו |
| אין נגררת עם אותו תאריך | הנגררת הקיימת משוכפלת עם השינויים |

---

### '3' - פעולת ביטול

משמשת לביטול נתונים או לדיווח גמר תוקף.

> [!CAUTION]
> **הבדל חשוב:**
> - **ביטול נגררת** - לא נשאר זכר בקובץ, לא תהיה השפעה ברטרו
> - **גמר תוקף** - הנגררת נשארת ומשפיעה על תקופות קודמות

**אופן השימוש:**
1. לביטול נגררת - לדווח את המפתח המלא
2. לגמר תוקף - לדווח בשדה "תאריך תוקף" את התאריך שממנו הנגררת לא בתוקף

---

### '4' - פעולת קביעה

מוגדרת רק לאירועים שמפתחם כולל תאריך תוקף.

מאפשרת דיווח נתונים לקובץ **ללא תלות בתוכנו הנוכחי** - הנתונים המדווחים קובעים את המצב החדש.

**מתי להשתמש:**
1. הוספת נגררת כשיש בקובץ נגררת מאוחרת ממנה
2. החלפת נגררות אחדות בבת אחת

> [!CAUTION]
> זו הפעולה החזקה ביותר! בעדכון מקוון ניתנת התראה על מספר הנגררות שיוחלפו.

---

### '5' - ביטול מאסיבי

מבטלת נגררות החל מהתאריך שדווח והלאה.

- **אירוע חסר גמר תוקף** - יש לדווח תאריך מדויק של נגררת קיימת
- **אירוע בעל גמר תוקף** - יש לדווח תאריך בתוקף של אחת הנגררות

---

## 2.6 חובת דיווח

| סוג שדה | חובת דיווח |
|---------|-----------|
| שדה מפתח | חובה בכל קודי הפעולה |
| שדה חובה | חובה בהוספה |
| שאר השדות | רק שדות שהשתנו |

**ברירת מחדל** - הערך שיינתן לשדה כאשר אין דיווח מהמשתמש.

---

## 2.7 כללי רישום השדות

### תאריך

**צורות דיווח מותרות:**

| סוג | דוגמאות |
|-----|---------|
| חודש + שנה | 0298, 021998, 02.98, 02/98, 02/1998 |
| יום + חודש + שנה | 010294, 01021994, 01.02.94, 01/02/94 |

**כללי שנה:**
- שנים 00-29 → מאה 21 (2000-2029)
- שנים 30-99 → מאה 20 (1930-1999)
- לפתיחת אירוע שנסגר: לדווח 9999 או 999999

> [!TIP]
> כשהיום או החודש לא ידועים (כמו בתאריך לידה), ניתן לדווח אפסים במקומם.

### טקסט עברי
- בעדכון בתקשורת: ניתן עברי, אנגלי ודו-לשוני
- בעדכון באצווה: רק עברי (למעט שדות מוגדרים לאנגלית)

### סכום / כמות
- אין צורך באפסים מובילים
- השדות כוללים אגורות

### סמל
- **יש לרשום אפסים מובילים**

---

## 2.8 הודעות שגיאה בדו"ח הקליטה

כל נתון עובר בדיקות תקינות וסבירות.

| סוג הודעה | משמעות |
|-----------|--------|
| **שגיאה** | האירוע לא נקלט |
| **אזהרה** | האירוע נקלט, אך יש תופעה חריגה |

רשימת הודעות השגיאה מופיעה בפרסום "מדריך למשתמש - הודעות שגיאה".
