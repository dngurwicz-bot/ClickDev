# הצגת תיק העובד

תיק העובד הנו **השירות המרכזי** בחילן פרו.

השירות משלב בתוכו את שירותי האחזור ועדכון הנתונים לעובד (שירותים 2 ו-12).

---

## איתור ובחירת עובד

לפני הגישה לתיק העובד יש ראשית לאתר ולבחור את העובד:

### אפשרויות חיפוש
- לפי **מספר עובד**
- לפי **שם משפחה**
- למשתמשים עם "עץ ארגוני" - לפי **שם פרטי** (לאחר איפוס שאר השדות)

### חיפוש אינקרמנטלי
בשדות השם - המערכת מתחילה את החיפוש עם הקשת האות הראשונה.

### כניסה לתיק עובד
- סימון העובד ולחיצה על צלמית **"תיק העובד"**
- או הקשה כפולה על שורת פרטי העובד

---

## כפתורי פעולה

| כפתור | פעולה |
|--------|-------|
| **חיפוש עובד בעל נתון דומה** | מציאת עובד אחר שגם אצלו קיימים נתונים באותו אירוע |
| **העובד הבא במאגר** | מעבר לעובד הבא (לפי מספר עובד) מכל מאגר העובדים |
| **עריכת נתונים** | שינוי נתוני העובד (מקביל לשירות 2) |
| **העובד הבא ברשימה** | ניווט לעובד הבא מתוך רשימת העובדים שנקבעה |
| **העובד הקודם ברשימה** | ניווט לעובד הקודם מתוך רשימת העובדים שנקבעה |

### עריכת נתונים
- האירועים המוצגים הם אלו שנבחרו כ"מועדפים" בתפריט האירועים
- לעריכת נתונים אחרים: בחירת **"אחר"** לפתיחת טבלת כל האירועים

---

## תקציר אירועים

### מבנה תיק העובד
- מחולק ל**כרטסות** לפי נושאים
- בכל כרטסת - האירועים השייכים לנושא הנבחר
- **דוגמה**: בכרטסת השכר יופיעו אירועי 209, 413, 440 וכו'

### תצוגת אירועים
- מוצגים רק האירועים הקיימים לאותו עובד
- לצפייה בנתוני אירוע: סימון באמצעות העכבר

### תפריט האירועים (צד ימין)
אירועים ממוינים בתיקיות לפי סוגם:
- פרטים אישיים
- פרטי העסקה
- שכר
- נוכחות
- משאבי אנוש
- מסמכים
- **מועדפים** (אירועים מכל התיקיות שנבחרו מראש)

### הוספת אירוע למועדפים
- לחיצה ימנית על שם האירוע
- אישור בתיבת השאלה

> **הערה**: אירועים ללא נתונים לעובד - לא יוצגו

### תצוגת נתוני אירוע
לחיצה על אירוע מציגה בצד שמאל:
- כל השדות באותו אירוע
- ערכיהם לאותו עובד

### תקציר כרטסת
- בראש כל רשימת אירועים מופיע תקציר
- תקציר = תצוגה מובנת של מספר אירועים באותו נושא
- **הגדרת תקציר מותאם אישית**: תפריט דוחות → דוחות אופק → הגדרת תקציר

---

## כרטסת מועדפים

כרטסת בה אתה מגדיר את רשימת האירועים שיוצגו בה.

### הוספת/הסרת אירועים

#### אפשרות 1: קליק ימני
- הקשה ימנית על אירוע בכרטסות אחרות → הוספה
- הקשה ימנית על אירוע במועדפים → הסרה

#### אפשרות 2: תפריט הגדרות
כלים → ההגדרות שלי → בחירת מועדפים

---

## טווח תאריכים

מעל נתוני העובד - תיבת אפשרויות לטווח תאריכים:

| אפשרות | תיאור |
|--------|-------|
| **הכל** | ללא הגבלת תאריכים |
| **חודש העיבוד** | חודש העיבוד הנוכחי |
| **לפי תאריכים** | בחירת המשתמש - הגדרת שדות התאריכים |
| **חישוב אחרון** | חודש חישוב אחרון |
| **מתח' שנת המס** | מתחילת השנה הנוכחית ועד היום |

---

## מקבץ נתונים לעובד

אפשרות נוספת לצפייה בריכוז נתונים לעובד.

### הגדרת מקבץ
- נוצר בידי מתאם הלקוח (לפי דרישת הלקוח)
- הגדרת רשימת האירועים למקבץ
- מתן כותרת מתאימה
- בדומה להגדרת תהליך מונחה בשירות 12

### צפייה במקבץ
- לחיצה על צלמית **"מקבץ נתונים לעובד"** בשורת הצלמיות
- בחירת המקבץ הרצוי לפי שמו

---

## יצוא

אפשרות לייצא את הנתונים המופיעים בתיק העובד לתוכנה אחרת.

### כפתור יצוא
ממוקם בסרגל הכלים

### אפשרויות יצוא
| סוג | תיאור |
|-----|-------|
| **יצוא לאופק** | העברה למערכת אופק |
| **יצוא לגיליון אלקטרוני** | העברה לקובץ Excel (xls) |

---

## מבנה הטבלאות

המערכת בנויה מ**טבלאות**, כאשר כל טבלה מקושרת לעובד ומיוצגת גם במסד הנתונים.

### מצבי טבלה

לכל טבלה קיימים 2 מצבים:

| מצב | תיאור | קוד קידומת |
|-----|-------|------------|
| **צפייה** | תצוגת קריאה בלבד של הנתונים | `1` |
| **הזנה** | עריכה והזנת נתונים חדשים | `2` |

### ניווט מהיר (קיצורים)

ניתן לנווט ישירות לטבלה ולמצב הרצוי באמצעות הקשת קוד בשדה הניווט:

| קוד | פעולה |
|-----|-------|
| `1100` | טבלה 100 - מצב **צפייה** |
| `2100` | טבלה 100 - מצב **הזנה** |
| `1001` | טבלה 001 - מצב **צפייה** |
| `2001` | טבלה 001 - מצב **הזנה** |

### נוסחת הקוד

```
[מצב][מספר טבלה]
```

- **מצב 1** = צפייה (קריאה)
- **מצב 2** = הזנה (עריכה)
- **מספר טבלה** = 3 ספרות (001, 100, וכו')

### דוגמאות טבלאות

| קוד טבלה | שם | תיאור |
|----------|-----|-------|
| `001` | פרטים אישיים | נתונים בסיסיים של העובד |
| `100` | עדכון שם | היסטוריית שינויי שם |

---

## קוד פעולה (Operation Codes)

בעת עדכון או הזנת נתונים (מצב `2`), המערכת משתמשת בקודי פעולה לקביעת סוג העדכון:

| קוד | שם | תיאור |
|-----|-----|-------|
| ` ` | **עדכון / שינוי** | יצירת רשומה חדשה בהיסטוריה (מעבר המצב הנוכחי להיסטוריה). |
| `2` | **תיקון** | עדכון הנתון הנוכחי ללא יצירת רשומת היסטוריה נוספת. |
| `3` | **ביטול / מחיקה** | ביטול רשומה מההיסטוריה ושחזור המצב לקדמותו. |
| `4` | **הזנה היסטורית** | הכנסת רשומה לתוך רצף ההיסטוריה בתאריך עבר. |

---

## לוגיקת עדכון וסנכרון

כדי לשמור על חוויית משתמש עקבית, המערכת מיישמת את הכללים הבאים:

1. **עקביות הכותרת**: כותרת העובד תציג תמיד את המידע היציב ביותר (Fallback). אם שדה בטופס ריק, המערכת תציג את הנתון השמור האחרון.
2. **הגנה על נתונים**: שליחת שדה ריק בטופס תיקון/עדכון לא תמחוק נתון קיים (שימוש בלוגיקת `COALESCE` בשרת).
3. **סנכרון מיידי**: לאחר ביצוע פעולת "ביטול רשומה", המערכת מרעננת את תצוגת הכותרת וההיסטוריה באופן אוטומטי ללא צורך ברענון דף.

